

































<title>Percona Monitoring and Management &mdash; Develop Advisor checks</title>

<head>
    


    
<script src="../js/version-select.js" type="text/javascript"></script>

<script src="../js/toctree.js" type="text/javascript"></script>

<script src="../js/lightgallery.min.js" type="text/javascript"></script>


<script>
    var elements = document.getElementsByClassName("lightgallery");
    for(var i=0; i<elements.length; i++) {
       lightGallery(elements[i]);
    }
</script>

    <link rel="top" title="" href="https://www.percona.com/doc/percona-monitoring-and-management/2.x" />
    
    <link rel="next" title="FAQ" href="../faq.html" />
    
    
</head>

<body>
    <div class="container">
        
<link rel="stylesheet" href="../css/version-select.css" type="text/css">
<link rel="stylesheet" href="../css/toctree.css" type="text/css">

        
<script src="../js/version-select.js" type="text/javascript"></script>

<script src="../js/toctree.js" type="text/javascript"></script>

<script src="../js/lightgallery.min.js" type="text/javascript"></script>


<script>
    var elements = document.getElementsByClassName("lightgallery");
    for(var i=0; i<elements.length; i++) {
       lightGallery(elements[i]);
    }
</script>

        <div class="document row">
            <div class="documentwrapper col-md-9 col-md-push-3">
                
<div class="related row">
    <ul class="nav nav-pills">
        
        <li class="right" style="margin-right: 10px">
            <a href="../faq.html" title="FAQ">Next</a>
        </li>
        
        
        <li class="right" style="margin-right: 10px">
            <a href="glossary.html" title="Glossary">Previous</a>
        </li>
        
        <li>
            <a href="https://www.percona.com/doc/percona-monitoring-and-management/2.x">Home</a>
        </li>
    </ul>
</div>

                

<div class="small">
    <ul class="list-inline">
        <li class="pull-right">
            <a href="https://github.com/percona/pmm-doc/edit/main/docs/details/develop-checks.md" target="_blank" title=""><i class="uil uil-pen"></i> <b>Edit this page</b></a>
        </li>
    </ul>
</div>


                <div class="bodywrapper">
                    <div class="body">
                        <h1 id="develop-advisor-checks">Develop Advisor checks<a class="headerlink" href="#develop-advisor-checks" title="Permanent link">&para;</a></h1>
<p>PMM offer sets of checks that can detect common security threats, performance degradation, data loss and data corruption.</p>
<p>As a developer, you can create custom checks to cover additional use cases, relevant to your specific database infrastructure.</p>
<h2 id="check-components">Check components<a class="headerlink" href="#check-components" title="Permanent link">&para;</a></h2>
<p>A check is a combination of:</p>
<ul>
<li>A query for extracting data from the database.</li>
<li>Python script for converting extracted data into check results. This is actually a <a href="https://github.com/google/starlark-go">Starlark</a> script, which is a Python dialect that adds more imperative features than Python. The script&rsquo;s execution environment is sandboxed, and no I/O can be done from it.</li>
</ul>
<p>All checks are self-contained in the first phase, as well as in most of the planned phases.</p>
<p>This means that extracted data is processed on the PMM side and not sent back to the SaaS.</p>
<h2 id="backend">Backend<a class="headerlink" href="#backend" title="Permanent link">&para;</a></h2>
<ol>
<li>pmm-managed checks that the installation is opted-in for checks.</li>
<li>pmm-managed downloads files with checks from SaaS.</li>
<li>pmm-managed verifies file signatures using a list of hard-coded public keys. At least one signature should be correct.</li>
<li>pmm-managed sends queries to pmm-agent and gathers results.</li>
<li>pmm-managed executes check scripts that produce alert information.</li>
<li>pmm-managed sends alerts to Alermanager.</li>
<li>Due to Alertmanager design, pmm-managed has to send and re-send alerts to it much more often than the frequency with which checks are executed. This expected behaviour is not important for using checks but is important for understanding how checks work.</li>
<li>Currently, Prometheus is not involved.</li>
</ol>
<p><div class="lightgallery"><a data-sub-html="" href="../_images/BackendChecks.png"><img alt="" src="../_images/BackendChecks.png" /></a></div></p>
<h2 id="frontend">Frontend<a class="headerlink" href="#frontend" title="Permanent link">&para;</a></h2>
<p>PMM uses Aletmanager API to get information about failed checks and show them on the UI:</p>
<p><div class="lightgallery"><a data-sub-html="" href="../_images/FrontEndChecks.png"><img alt="" src="../_images/FrontEndChecks.png" /></a></div></p>
<h2 id="check-fields">Check fields<a class="headerlink" href="#check-fields" title="Permanent link">&para;</a></h2>
<p>Checks include the following fields:  </p>
<ul>
<li><strong>Version</strong> (integer, required): defines what other properties are expected, what types are supported, what is expected from the script and what it can expect from the execution environment, etc.</li>
<li><strong>Name</strong> (string, required): defines machine-readable name (ID).</li>
<li><strong>Summary</strong> (string, required): defines short human-readable description.</li>
<li><strong>Description</strong> (string, required): defines long human-readable description.</li>
<li><strong>Interval</strong> (string/enum, optional): defines running interval. Can be one of the predefined intervals in the UI: Standard, Frequent, Rare.</li>
<li><strong>Type</strong> (string/enum, required): defines the query type and the PMM Service type for which the advisor runs. Check the list of available types in the table below.</li>
<li><strong>Query</strong> (string, can be absent if the type defines the whole query by itself): The query is executed on the PMM Client side and contains query specific for the target DBMS.</li>
<li><strong>Script</strong> (string, required): contains a small Starlark program that processes query results, and returns check results. It is executed on the PMM Server side.</li>
</ul>
<h2 id="checks-script">Checks script<a class="headerlink" href="#checks-script" title="Permanent link">&para;</a></h2>
<p>The check script assumes that there is a function with a fixed name, that accepts a <em>list</em> of <em>docs</em> containing returned rows for SQL databases and documents for MongoDB. It returns zero, one, or several check results that are then converted to alerts.</p>
<p>PMM 2.12.0 and earlier function name is <strong>check</strong>, while newer versions use name <strong>check_context</strong>. Both have the same meaning.</p>
<h3 id="function-signature">Function signature<a class="headerlink" href="#function-signature" title="Permanent link">&para;</a></h3>
<p>The function signature should be <strong>check_context</strong> (docs, context), where <strong>docs</strong> is lists of docs (one doc represents one row for SQL DBMS and one document for MongoDB).</p>
<h2 id="check-severity-levels">Check severity levels<a class="headerlink" href="#check-severity-levels" title="Permanent link">&para;</a></h2>
<p>PMM can display failed checks as <strong>Critical</strong>, <strong>Major</strong> or <strong>Trivial</strong>. These three severity levels correspond to the following severity types in the check source:</p>
<ul>
<li><strong>Critical</strong>: emergency, alert, critical</li>
<li><strong>Major</strong>: warning  </li>
<li><strong>Trivial</strong>: notice, info, debug</li>
</ul>
<h2 id="check-types">Check types<a class="headerlink" href="#check-types" title="Permanent link">&para;</a></h2>
<p>Expand the table below for the list of checks types that you can use to define your query type and the PMM Service type for which the check will run.</p>
<details class="note alert alert-info">
<summary>Check Types table (click to show/hide)</summary>
<table class="table">
<thead>
<tr>
<th scope="col">Check type</th>
<th scope="col">Description</th>
<th scope="col">&ldquo;query&rdquo; required (must be empty if &ldquo;No&rdquo;)</th>
</tr>
</thead>
<tbody>
<tr>
<td>MYSQL_SHOW</td>
<td>Executes &lsquo;SHOW …&rsquo; clause against MySQL database. This check is available  starting with PMM 2.6</td>
<td>Yes</td>
</tr>
<tr>
<td>MYSQL_SELECT</td>
<td>Executes &lsquo;SELECT …&rsquo; clause against MySQL database. This check is available  starting with PMM 2.6</td>
<td>Yes</td>
</tr>
<tr>
<td>POSTGRESQL_SHOW</td>
<td>Executes &lsquo;SHOW ALL&rsquo; command against PosgreSQL database. This check is available  starting with PMM 2.6.</td>
<td>No</td>
</tr>
<tr>
<td>POSTGRESQL_SELECT</td>
<td>Executes &lsquo;SELECT …&rsquo; clause against PosgreSQL database. This check is available  starting with PMM 2.6.</td>
<td>Yes</td>
</tr>
<tr>
<td>MONGODB_GETPARAMETER</td>
<td>Executes db.adminCommand( { getParameter: &ldquo;*&rdquo; } ) against MongoDB&rsquo;s &ldquo;admin&rdquo; database. This check is available  starting with PMM 2.6. For more information, see <a href="https://docs.mongodb.com/manual/reference/command/getParameter/">getParameter</a></td>
<td>No</td>
</tr>
<tr>
<td>MONGODB_BUILDINFO</td>
<td>Executes db.adminCommand( { buildInfo:  1 } ) against MongoDB&rsquo;s &ldquo;admin&rdquo; database. This check is available  starting with PMM 2.6. For more information, see <a href="https://docs.mongodb.com/manual/reference/command/buildInfo/">buildInfo</a></td>
<td>No</td>
</tr>
<tr>
<td>MONGODB_GETCMDLINEOPTS</td>
<td>Executes db.adminCommand( { getCmdLineOpts: 1 } ) against MongoDB&rsquo;s &ldquo;admin&rdquo; database. This check is available  starting with PMM 2.7. For more information, see <a href="https://docs.mongodb.com/manual/reference/command/getCmdLineOpts/">getCmdLineOpts</a></td>
<td>No</td>
</tr>
<tr>
<td>MONGODB_REPLSETGETSTATUS</td>
<td>Executes db.adminCommand( { replSetGetStatus: 1 } ) against MongoDB&rsquo;s &ldquo;admin&rdquo; database. This check is available  starting with PMM 2.27. For more information, see  <a href="https://docs.mongodb.com/manual/reference/command/replSetGetStatus/">replSetGetStatus</a></td>
<td>No</td>
</tr>
<tr>
<td>MONGODB_GETDIAGNOSTICDATA</td>
<td>Executes db.adminCommand( { getDiagnosticData: 1 } ) against MongoDB&rsquo;s &ldquo;admin&rdquo; database. This check is available  starting with PMM 2.27. For more information, see <a href="https://docs.mongodb.com/manual/administration/analyzing-mongodb-performance/#full-time-diagnostic-data-capture">MongoDB Performance</a></td>
<td>No</td>
</tr>
</tbody>
</table>
</details>
<h2 id="develop-custom-checks">Develop custom checks<a class="headerlink" href="#develop-custom-checks" title="Permanent link">&para;</a></h2>
<ol>
<li>Install the latest PMM Server and PMM Client builds following the <a href="https://www.percona.com/software/pmm/quickstart#">installation instructions</a>. </li>
<li>
<p>Run PMM Server with special environment variables:</p>
<ul>
<li><em>PMM_DEBUG=1</em> to enable debug output that would be useful later;</li>
<li><em>PERCONA_TEST_CHECKS_FILE=/srv/custom-checks.yml</em> to use checks from the local files instead of downloading them from the SaaS.</li>
<li><em>PERCONA_TEST_CHECKS_DISABLE_START_DELAY=true</em> to disable the default check execution start delay. This is currently set to one minute, so that checks run upon system start.</li>
<li><em>PERCONA_TEST_CHECKS_RESEND_INTERVAL=2s</em> to define the frequency for sending the SA-based alerts to Alertmanager.</li>
</ul>
<div class="highlight"><pre><span></span><code>docker run -p 80:80 -p 443:443 --name pmm-server \
-e PMM_DEBUG=1 \
-e PERCONA_TEST_CHECKS_FILE=/srv/custom-checks.yml \
-e PERCONA_TEST_CHECKS_DISABLE_START_DELAY=true \
-e PERCONA_TEST_CHECKS_RESEND_INTERVAL=2s \
perconalab/pmm-server:dev-latest
</code></pre></div>
</li>
<li>
<p>Log in to Grafana with credentials <strong>admin/admin</strong>.</p>
</li>
<li>
<p>Go to <strong>Configuration &gt; Settings &gt; Advanced Settings</strong> and enable <strong>Advisors</strong>. For PMM 2.26 and older this option is called <strong>Security Threat Tool</strong>.</p>
</li>
<li>
<p>Create <em>/srv/custom-checks.yml</em> inside a Docker container with the content of your check.</p>
</li>
<li>
<p>The checks will run according to the time interval defined on the UI. You can see the result of running the check on the home dashboard:</p>
<p><div class="lightgallery"><a data-sub-html="" href="../_images/HomeDashboard.png"><img alt="" src="../_images/HomeDashboard.png" /></a></div></p>
</li>
<li>
<p>Click on the number of failed checks to open the Failed Checks dashboard:</p>
<p><div class="lightgallery"><a data-sub-html="" href="../_images/FailedChecks.png"><img alt="" src="../_images/FailedChecks.png" /></a></div></p>
</li>
<li>
<p>Go into Docker container to output the logs of pmm-managed and read check logs:</p>
</li>
</ol>
<div class="highlight"><pre><span></span><code># get inside the container
docker exec -it pmm-server bash
# print and watch the logs
supervisorctl tail -f pmm-managed
</code></pre></div>
<h3 id="checks-format">Checks Format<a class="headerlink" href="#checks-format" title="Permanent link">&para;</a></h3>
<p>To create checks use the following format:
<div class="highlight"><pre><span></span><code><span class="nn">---</span><span class="w"></span>
<span class="nt">checks</span><span class="p">:</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w"></span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example</span><span class="w"></span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">summary</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Example check</span><span class="w"></span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">This check is just an example.</span><span class="w"></span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MONGODB_BUILDINFO</span><span class="w"></span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">script</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">|</span><span class="w"></span>
<span class="w">    </span><span class="no">def check(docs):</span><span class="w"></span>
<span class="w">        </span><span class="no"># for compatibility with PMM Server &lt; 2.12</span><span class="w"></span>
<span class="w">        </span><span class="no">context = {</span><span class="w"></span>
<span class="w">            </span><span class="no">&quot;format_version_num&quot;: format_version_num,</span><span class="w"></span>
<span class="w">            </span><span class="no">&quot;parse_version&quot;: parse_version,</span><span class="w"></span>
<span class="w">        </span><span class="no">}</span><span class="w"></span>
<span class="w">        </span><span class="no">return check_context(docs, context)</span><span class="w"></span>


<span class="w">    </span><span class="no">def check_context(docs, context):</span><span class="w"></span>
<span class="w">        </span><span class="no"># `docs` is a frozen (deeply immutable) list of dicts where each dict represents a single document in result set.</span><span class="w"></span>
<span class="w">        </span><span class="no"># `context` is a dict with additional functions.</span><span class="w"></span>
<span class="w">        </span><span class="no">#</span><span class="w"></span>
<span class="w">        </span><span class="no"># Global `print` and `fail` functions are available.</span><span class="w"></span>
<span class="w">        </span><span class="no">#</span><span class="w"></span>
<span class="w">        </span><span class="no"># `check_context` function is expected to return a list of dicts that are then converted to alerts;</span><span class="w"></span>
<span class="w">        </span><span class="no"># in particular, that list can be empty.</span><span class="w"></span>
<span class="w">        </span><span class="no"># Any other value (for example, string) is treated as script execution failure</span><span class="w"></span>
<span class="w">        </span><span class="no"># (Starlark does not support Python exceptions);</span><span class="w"></span>
<span class="w">        </span><span class="no"># it is recommended to use global function `fail` for that instead.</span><span class="w"></span>

<span class="w">        </span><span class="no">format_version_num = context.get(&quot;format_version_num&quot;, fail)</span><span class="w"></span>
<span class="w">        </span><span class="no">parse_version = context.get(&quot;parse_version&quot;, fail)</span><span class="w"></span>

<span class="w">        </span><span class="no">print(&quot;first doc =&quot;, repr(docs[0]))</span><span class="w"></span>

<span class="w">        </span><span class="no">return [{</span><span class="w"></span>
<span class="w">            </span><span class="no">&quot;summary&quot;: &quot;Example summary&quot;,</span><span class="w"></span>
<span class="w">            </span><span class="no">&quot;description&quot;: &quot;Example description&quot;,</span><span class="w"></span>
<span class="w">            </span><span class="no">&quot;severity&quot;: &quot;warning&quot;,</span><span class="w"></span>
<span class="w">            </span><span class="no">&quot;labels&quot;: {</span><span class="w"></span>
<span class="w">                </span><span class="no">&quot;version&quot;: format_version_num(10203),</span><span class="w"></span>
<span class="w">            </span><span class="no">}</span><span class="w"></span>
<span class="w">        </span><span class="no">}]</span><span class="w"></span>
</code></pre></div>
Here&rsquo;s a more realistic example</p>
<div class="highlight"><pre><span></span><code><span class="nn">---</span><span class="w"></span>
<span class="w">    </span><span class="nt">checks</span><span class="p">:</span><span class="w"></span>
<span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w"></span>
<span class="w">         </span><span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mongodb_version</span><span class="w"></span>
<span class="w">         </span><span class="l l-Scalar l-Scalar-Plain">summary</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MongoDB Version</span><span class="w"></span>
<span class="w">         </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">This check returns warnings if MongoDB/PSMDB version is not the latest one.</span><span class="w"></span>
<span class="w">         </span><span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MONGODB_BUILDINFO</span><span class="w"></span>
<span class="w">         </span><span class="l l-Scalar l-Scalar-Plain">script</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">|</span><span class="w"></span>
<span class="w">         </span><span class="no">LATEST_VERSIONS = {</span><span class="w"></span>
<span class="w">             </span><span class="no">&quot;mongodb&quot;: {</span><span class="w"></span>
<span class="w">                 </span><span class="no">&quot;3.6&quot;: 30620,  # https://docs.mongodb.com/manual/release-notes/3.6/</span><span class="w"></span>
<span class="w">                 </span><span class="no">&quot;4.0&quot;: 40020,  # https://docs.mongodb.com/manual/release-notes/4.0/</span><span class="w"></span>
<span class="w">                 </span><span class="no">&quot;4.2&quot;: 40210,  # https://docs.mongodb.com/manual/release-notes/4.2/</span><span class="w"></span>
<span class="w">                 </span><span class="no">&quot;4.4&quot;: 40401,  # https://docs.mongodb.com/manual/release-notes/4.4/</span><span class="w"></span>
<span class="w">             </span><span class="no">},</span><span class="w"></span>
<span class="w">             </span><span class="no">&quot;percona&quot;: {</span><span class="w"></span>
<span class="w">                 </span><span class="no">&quot;3.6&quot;: 30620,  # https://www.percona.com/downloads/percona-server-mongodb-3.6/</span><span class="w"></span>
<span class="w">                 </span><span class="no">&quot;4.0&quot;: 40020,  # https://www.percona.com/downloads/percona-server-mongodb-4.0/</span><span class="w"></span>
<span class="w">                 </span><span class="no">&quot;4.2&quot;: 40209,  # https://www.percona.com/downloads/percona-server-mongodb-4.2/</span><span class="w"></span>
<span class="w">                 </span><span class="no">&quot;4.4&quot;: 40401,  # https://www.percona.com/downloads/percona-server-mongodb-4.4/</span><span class="w"></span>
<span class="w">             </span><span class="no">},</span><span class="w"></span>
<span class="w">         </span><span class="no">}</span><span class="w"></span>


<span class="w">         </span><span class="no">def check(docs):</span><span class="w"></span>
<span class="w">             </span><span class="no"># for compatibility with PMM Server &lt; 2.12</span><span class="w"></span>
<span class="w">             </span><span class="no">context = {</span><span class="w"></span>
<span class="w">                 </span><span class="no">&quot;format_version_num&quot;: format_version_num,</span><span class="w"></span>
<span class="w">                 </span><span class="no">&quot;parse_version&quot;: parse_version,</span><span class="w"></span>
<span class="w">             </span><span class="no">}</span><span class="w"></span>
<span class="w">             </span><span class="no">return check_context(docs, context)</span><span class="w"></span>


<span class="w">         </span><span class="no">def check_context(docs, context):</span><span class="w"></span>
<span class="w">             </span><span class="no"># `docs` is a frozen (deeply immutable) list of dicts where each dict represents a single document in result set.</span><span class="w"></span>
<span class="w">             </span><span class="no"># `context` is a dict with additional functions.</span><span class="w"></span>
<span class="w">             </span><span class="no">#</span><span class="w"></span>
<span class="w">             </span><span class="no"># Global `print` and `fail` functions are available.</span><span class="w"></span>
<span class="w">             </span><span class="no">#</span><span class="w"></span>
<span class="w">             </span><span class="no"># `check_context` function is expected to return a list of dicts that are then converted to alerts;</span><span class="w"></span>
<span class="w">             </span><span class="no"># in particular, that list can be empty.</span><span class="w"></span>
<span class="w">             </span><span class="no"># Any other value (for example, string) is treated as script execution failure</span><span class="w"></span>
<span class="w">             </span><span class="no"># (Starlark does not support Python exceptions);</span><span class="w"></span>
<span class="w">             </span><span class="no"># it is recommended to use global function `fail` for that instead.</span><span class="w"></span>

<span class="w">             </span><span class="no">&quot;&quot;&quot;</span><span class="w"></span>
<span class="w">             </span><span class="no">This check returns warnings if MongoDB/PSMDB version is not the latest one.</span><span class="w"></span>
<span class="w">             </span><span class="no">&quot;&quot;&quot;</span><span class="w"></span>

<span class="w">             </span><span class="no">format_version_num = context.get(&quot;format_version_num&quot;, fail)</span><span class="w"></span>
<span class="w">             </span><span class="no">parse_version = context.get(&quot;parse_version&quot;, fail)</span><span class="w"></span>

<span class="w">             </span><span class="no">if len(docs) != 1:</span><span class="w"></span>
<span class="w">                 </span><span class="no">return &quot;Unexpected number of documents&quot;</span><span class="w"></span>

<span class="w">             </span><span class="no">info = docs[0]</span><span class="w"></span>

<span class="w">             </span><span class="no"># extract information</span><span class="w"></span>
<span class="w">             </span><span class="no">is_percona = &#39;psmdbVersion&#39; in info</span><span class="w"></span>

<span class="w">             </span><span class="no"># parse_version returns a dict with keys: major, minor, patch, rest, num</span><span class="w"></span>
<span class="w">             </span><span class="no">version = parse_version(info[&quot;version&quot;])</span><span class="w"></span>
<span class="w">             </span><span class="no">print(&quot;version =&quot;, repr(version))</span><span class="w"></span>
<span class="w">             </span><span class="no">num = version[&quot;num&quot;]</span><span class="w"></span>
<span class="w">             </span><span class="no">mm = &quot;{}.{}&quot;.format(version[&quot;major&quot;], version[&quot;minor&quot;])</span><span class="w"></span>

<span class="w">             </span><span class="no">results = []</span><span class="w"></span>

<span class="w">             </span><span class="no">if is_percona:</span><span class="w"></span>
<span class="w">                 </span><span class="no">latest = LATEST_VERSIONS[&quot;percona&quot;][mm]</span><span class="w"></span>
<span class="w">                 </span><span class="no">if latest &gt; num:</span><span class="w"></span>
<span class="w">                     </span><span class="no">results.append({</span><span class="w"></span>
<span class="w">                         </span><span class="no">&quot;summary&quot;: &quot;Newer version of Percona Server for MongoDB is available&quot;,</span><span class="w"></span>
<span class="w">                         </span><span class="no">&quot;description&quot;: &quot;Current version is {}, latest available version is {}.&quot;.format(format_version_num(num), format_version_num(latest)),</span><span class="w"></span>
<span class="w">                         </span><span class="no">&quot;severity&quot;: &quot;warning&quot;,</span><span class="w"></span>
<span class="w">                         </span><span class="no">&quot;labels&quot;: {</span><span class="w"></span>
<span class="w">                             </span><span class="no">&quot;current&quot;: format_version_num(num),</span><span class="w"></span>
<span class="w">                             </span><span class="no">&quot;latest&quot;:  format_version_num(latest),</span><span class="w"></span>
<span class="w">                         </span><span class="no">},</span><span class="w"></span>
<span class="w">                     </span><span class="no">})</span><span class="w"></span>

<span class="w">                 </span><span class="no">return results</span><span class="w"></span>

<span class="w">             </span><span class="no">if True:  # MongoDB</span><span class="w"></span>
<span class="w">                 </span><span class="no">latest = LATEST_VERSIONS[&quot;mongodb&quot;][mm]</span><span class="w"></span>
<span class="w">                 </span><span class="no">if latest &gt; num:</span><span class="w"></span>
<span class="w">                     </span><span class="no">results.append({</span><span class="w"></span>
<span class="w">                         </span><span class="no">&quot;summary&quot;: &quot;Newer version of MongoDB is available&quot;,</span><span class="w"></span>
<span class="w">                         </span><span class="no">&quot;description&quot;: &quot;Current version is {}, latest available version is {}.&quot;.format(format_version_num(num), format_version_num(latest)),</span><span class="w"></span>
<span class="w">                         </span><span class="no">&quot;severity&quot;: &quot;warning&quot;,</span><span class="w"></span>
<span class="w">                         </span><span class="no">&quot;labels&quot;: {</span><span class="w"></span>
<span class="w">                             </span><span class="no">&quot;current&quot;: format_version_num(num),</span><span class="w"></span>
<span class="w">                             </span><span class="no">&quot;latest&quot;:  format_version_num(latest),</span><span class="w"></span>
<span class="w">                         </span><span class="no">},</span><span class="w"></span>
<span class="w">                     </span><span class="no">})</span><span class="w"></span>

<span class="w">                   </span><span class="no">return results</span><span class="w"></span>
</code></pre></div>
<h2 id="security-checks-in-pmm-226-and-older">Security checks in PMM 2.26 and older<a class="headerlink" href="#security-checks-in-pmm-226-and-older" title="Permanent link">&para;</a></h2>
<p>PMM 2.26 and older included a set of security checks grouped under the <strong>Security Threat Tool</strong> option.</p>
<p>With the 2.27 release, security checks have been renamed to Advisor checks, and the <strong>Security Threat Tool</strong> option in the PMM Settings was renamed to <strong>Advisors</strong>.</p>
<h2 id="submit-feedback">Submit feedback<a class="headerlink" href="#submit-feedback" title="Permanent link">&para;</a></h2>
<p>We welcome your feedback on the current process for developing and debugging checks. Send us your comments over <a href="https://percona.slack.com">Slack</a> or post a question on the <a href="https://forums.percona.com/">Percona Forums</a>.</p>
                    </div>
                </div>
                
<div class="small">
    <ul class="list-inline">
        
        <li class="left">
            <i class="uil uil-refresh"></i> Page updated 2022-04-21
        </li>
        
    </ul>
</div>

                
<div class="related row">
    <ul class="nav nav-pills">
        
        <li class="right" style="margin-right: 10px">
            <a href="../faq.html" title="FAQ">Next</a>
        </li>
        
        
        <li class="right" style="margin-right: 10px">
            <a href="glossary.html" title="Glossary">Previous</a>
        </li>
        
        <li>
            <a href="https://www.percona.com/doc/percona-monitoring-and-management/2.x">Home</a>
        </li>
    </ul>
</div>

            </div>
            
<div class="sphinxsidebar col-md-3 col-md-pull-9">
    <div class="sphinxsidebarwrapper">
        {@ product_logo @}
        {@ product_pdf_download @}
        
<section class="select-wrapper" id="version-select-wrapper">
    <!-- Empty locator section for version selector -->
</section>

        <h3 id="toctree-heading"><a href="https://www.percona.com/doc/percona-monitoring-and-management/2.x">Contents</a></h3>
        

<ul class="toctree" id="toctree">


<li class="toctree-l1">
    <a class="reference internal" href="../index.html">Welcome</a>




<li class="toctree-l1">
    <a class="reference internal" href="../setting-up/index.html">Setting up</a>




<ul class="toctree" id="toctree">


<li class="toctree-l2">
    <a class="reference internal" href="../setting-up/server/index.html">Server</a>




<ul class="toctree" id="toctree">


<li class="toctree-l3">
    <a class="reference internal" href="../setting-up/server/network.html">Network</a>




<li class="toctree-l3">
    <a class="reference internal" href="../setting-up/server/docker.html">Docker</a>




<li class="toctree-l3">
    <a class="reference internal" href="../setting-up/server/virtual-appliance.html">Virtual Appliance</a>




<li class="toctree-l3">
    <a class="reference internal" href="../setting-up/server/aws.html">AWS Marketplace</a>




<li class="toctree-l3">
    <a class="reference internal" href="../setting-up/server/easy-install.html">Easy-install script</a>




<li class="toctree-l3">
    <a class="reference internal" href="../setting-up/server/dbaas.html">DBaaS</a>



</ul>





<li class="toctree-l2">
    <a class="reference internal" href="../setting-up/client/index.html">Client</a>




<ul class="toctree" id="toctree">


<li class="toctree-l3">
    <a class="reference internal" href="../setting-up/client/mysql.html">MySQL</a>




<li class="toctree-l3">
    <a class="reference internal" href="../setting-up/client/mongodb.html">MongoDB</a>




<li class="toctree-l3">
    <a class="reference internal" href="../setting-up/client/postgresql.html">PostgreSQL</a>




<li class="toctree-l3">
    <a class="reference internal" href="../setting-up/client/proxysql.html">ProxySQL</a>




<li class="toctree-l3">
    <a class="reference internal" href="../setting-up/client/aws.html">Amazon RDS</a>




<li class="toctree-l3">
    <a class="reference internal" href="../setting-up/client/azure.html">Microsoft Azure</a>




<li class="toctree-l3">
    <a class="reference internal" href="../setting-up/client/google.html">Google Cloud Platform</a>




<li class="toctree-l3">
    <a class="reference internal" href="../setting-up/client/linux.html">Linux</a>




<li class="toctree-l3">
    <a class="reference internal" href="../setting-up/client/external.html">External Services</a>




<li class="toctree-l3">
    <a class="reference internal" href="../setting-up/client/haproxy.html">HAProxy</a>




<li class="toctree-l3">
    <a class="reference internal" href="../setting-up/client/remote.html">Remote instances</a>



</ul>




</ul>





<li class="toctree-l1">
    <a class="reference internal" href="../using/index.html">Using</a>




<ul class="toctree" id="toctree">


<li class="toctree-l2">
    <a class="reference internal" href="../using/interface.html">User Interface</a>




<li class="toctree-l2">
    <a class="reference internal" href="../using/alerting.html">Integrated Alerting</a>




<li class="toctree-l2">
    <a class="reference internal" href="../using/backup.html">Backup and Restore</a>




<li class="toctree-l2">
    <a class="reference internal" href="../using/query-analytics.html">Query Analytics</a>




<li class="toctree-l2">
    <a class="reference internal" href="../using/dbaas.html">DBaaS</a>



</ul>





<li class="toctree-l1">
    <a class="reference internal" href="../how-to/index.html">How to</a>




<ul class="toctree" id="toctree">


<li class="toctree-l2">
    <a class="reference internal" href="../how-to/configure.html">Configure</a>




<li class="toctree-l2">
    <a class="reference internal" href="../how-to/manage-users.html">Manage users</a>




<li class="toctree-l2">
    <a class="reference internal" href="../how-to/upgrade.html">Upgrade</a>




<li class="toctree-l2">
    <a class="reference internal" href="../how-to/secure.html">Secure</a>




<li class="toctree-l2">
    <a class="reference internal" href="../how-to/optimize.html">Optimize</a>




<li class="toctree-l2">
    <a class="reference internal" href="../how-to/annotate.html">Annotate</a>




<li class="toctree-l2">
    <a class="reference internal" href="../how-to/render-dashboard-images.html">Render dashboard images</a>




<li class="toctree-l2">
    <a class="reference internal" href="../how-to/extend-metrics.html">Extend Metrics</a>




<li class="toctree-l2">
    <a class="reference internal" href="../how-to/troubleshoot.html">Troubleshoot</a>




<li class="toctree-l2">
    <a class="reference internal" href="../how-to/integrate-platform.html">Integrate with Percona Platform</a>




<ul class="toctree" id="toctree">


<li class="toctree-l3">
    <a class="reference internal" href="../how-to/account-info.html">Check Percona Portal account information</a>




<li class="toctree-l3">
    <a class="reference internal" href="../how-to/advisors.html">Work with Advisor checks</a>



</ul>




</ul>





<li class="toctree-l1">
    <a class="reference internal" href="index.html">Details</a>




<ul class="toctree" id="toctree">


<li class="toctree-l2">
    <a class="reference internal" href="architecture.html">Architecture</a>




<li class="toctree-l2">
    <a class="reference internal" href="interface.html">UI components</a>




<li class="toctree-l2">
    <a class="reference internal" href="dashboards/index.html">Dashboards</a>




<ul class="toctree" id="toctree">


<li class="toctree-l3">
    <a class="reference internal" href="dashboards/dashboard-home.html">Insight</a>




<ul class="toctree" id="toctree">


<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-advanced-data-exploration.html">Advanced Data Exploration</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-victoriametrics.html">VictoriaMetrics</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-victoriametrics-agents-overview.html">VictoriaMetrics Agents Overview</a>



</ul>





<li class="toctree-l3">
    <a class="reference internal" href="dashboards/dashboard-inventory.html">PMM</a>




<ul class="toctree" id="toctree">


<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-env-overview.html">Environment Overview</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-environent-summary.html">Environment Summary</a>



</ul>





<li class="toctree-l3">
    <a class="reference internal" href="dashboards/dashboard-cluster-summary.html">DBaas</a>




<li class="toctree-l3">
    <a class="reference internal" href="dashboards/dashboard-cpu-utilization-details.html">OS Dashboards</a>




<ul class="toctree" id="toctree">


<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-disk-details.html">Disk Details</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-network-details.html">Network Details</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-memory-details.html">Memory Details</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-node-temperature-details.html">Node Temperature Details</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-nodes-compare.html">Nodes Compare</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-nodes-overview.html">Nodes Overview</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-node-summary.html">Node Summary</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-numa-details.html">NUMA Details</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-processes-details.html">Processes Details</a>



</ul>





<li class="toctree-l3">
    <a class="reference internal" href="dashboards/dashboard-prometheus-exporter-status.html">Prometheus Dashboards</a>




<ul class="toctree" id="toctree">


<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-prometheus-exporters-overview.html">Prometheus Exporters Overview</a>



</ul>





<li class="toctree-l3">
    <a class="reference internal" href="dashboards/dashboard-mysql-amazon-aurora-details.html">MySQL Dashboards</a>




<ul class="toctree" id="toctree">


<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mysql-command-handler-counters-compare.html">MySQL Command/Handler Counters Compare</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mysql-innodb-compression-details.html">MySQL InnoDB Compression Details</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mysql-innodb-details.html">MySQL InnoDB Details</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mysql-myisam-aria-details.html">MySQL MyISAM/Aria Details</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mysql-myrocks-details.html">MySQL MyRocks Details</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mysql-instance-summary.html">MySQL Instance Summary</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mysql-instances-compare.html">MySQL Instances Compare</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mysql-instances-overview.html">MySQL Instances Overview</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mysql-wait-event-analyses-details.html">MySQL Wait Event Analyses Details</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mysql-performance-schema-details.html">MySQL Performance Schema Details</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mysql-query-response-time-details.html">MySQL Query Response Time Details</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mysql-replication-summary.html">MySQL Replication Summary</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mysql-group-replication-summary.html">MySQL Group Replication Summary</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mysql-table-details.html">MySQL Table Details</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mysql-user-details.html">MySQL User Details</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mysql-tokudb-details.html">MySQL TokuDB Details</a>



</ul>





<li class="toctree-l3">
    <a class="reference internal" href="dashboards/dashboard-mongodb-cluster-summary.html">MongoDB Dashboards</a>




<ul class="toctree" id="toctree">


<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mongodb-instance-summary.html">MongoDB Instance Summary</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mongodb-instances-overview.html">MongoDB Instances Overview</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mongodb-instances-compare.html">MongoDB Instances Compare</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mongodb-replset-summary.html">MongoDB ReplSet Summary</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mongodb-inmemory-details.html">MongoDB InMemory Details</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mongodb-mmapv1-details.html">MongoDB MMAPv1 Details</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-mongodb-wiredtiger-details.html">MongoDB WiredTiger Details</a>



</ul>





<li class="toctree-l3">
    <a class="reference internal" href="dashboards/dashboard-postgresql-instances-overview.html">PostgreSQL Dashboards</a>




<ul class="toctree" id="toctree">


<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-postgresql-instance-summary.html">PostgreSQL Instance Summary</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-postgresql-instances-compare.html">PostgreSQL Instances Compare</a>



</ul>





<li class="toctree-l3">
    <a class="reference internal" href="dashboards/dashboard-proxysql-instance-summary.html">ProxySQL Dashboards</a>




<li class="toctree-l3">
    <a class="reference internal" href="dashboards/dashboard-pxc-galera-node-summary.html">HA Dashboards</a>




<ul class="toctree" id="toctree">


<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-pxc-galera-cluster-summary.html">PXC/Galera Cluster Summary</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-pxc-galera-nodes-compare.html">PXC/Galera Nodes Compare</a>




<li class="toctree-l4">
    <a class="reference internal" href="dashboards/dashboard-haproxy-instance-summary.html">HAProxy Instance Summary</a>



</ul>




</ul>





<li class="toctree-l2">
    <a class="reference internal" href="commands/index.html">Commands</a>




<ul class="toctree" id="toctree">


<li class="toctree-l3">
    <a class="reference internal" href="commands/pmm-admin.html">pmm-admin - PMM Administration Tool</a>




<li class="toctree-l3">
    <a class="reference internal" href="commands/pmm-agent.html">pmm-agent - PMM Client agent</a>



</ul>





<li class="toctree-l2">
    <a class="reference internal" href="api.html">API</a>




<li class="toctree-l2">
    <a class="reference internal" href="victoria-metrics.html">VictoriaMetrics</a>




<li class="toctree-l2">
    <a class="reference internal" href="glossary.html">Glossary</a>




<li class="toctree-l2">
    <a class="reference internal" href="develop-checks.html">Develop Advisor checks</a>



</ul>





<li class="toctree-l1">
    <a class="reference internal" href="../faq.html">FAQ</a>




<li class="toctree-l1">
    <a class="reference internal" href="../release-notes/index.html">Release Notes</a>




<ul class="toctree" id="toctree">


<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.27.0.html">PMM 2.27.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.26.0.html">PMM 2.26.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.25.0.html">PMM 2.25.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.24.0.html">PMM 2.24.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.23.0.html">PMM 2.23.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.22.0.html">PMM 2.22.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.21.0.html">PMM 2.21.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.20.0.html">PMM 2.20.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.19.0.html">PMM 2.19.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.18.0.html">PMM 2.18.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.17.0.html">PMM 2.17.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.16.0.html">PMM 2.16.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.15.1.html">PMM 2.15.1</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.15.0.html">PMM 2.15.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.14.0.html">PMM 2.14.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.13.0.html">PMM 2.13.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.12.0.html">PMM 2.12.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.11.1.html">PMM 2.11.1</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.11.0.html">PMM 2.11.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.10.1.html">PMM 2.10.1</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.10.0.html">PMM 2.10.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.9.1.html">PMM 2.9.1</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.9.0.html">PMM 2.9.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.8.0.html">PMM 2.8.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.7.0.html">PMM 2.7.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.6.1.html">PMM 2.6.1</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.6.0.html">PMM 2.6.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.5.0.html">PMM 2.5.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.4.0.html">PMM 2.4.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.3.0.html">PMM 2.3.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.2.2.html">PMM 2.2.2</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.2.1.html">PMM 2.2.1</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.2.0.html">PMM 2.2.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.1.0.html">PMM 2.1.0</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.0.1.html">PMM 2.0.1</a>




<li class="toctree-l2">
    <a class="reference internal" href="../release-notes/2.0.0.html">PMM 2.0.0</a>



</ul>




</ul>


        

<h4>Previous page</h4>
<p class="topless">
    <a href="glossary.html" title="previous chapter">Glossary</a>
</p>


<h4>Next page</h4>
<p class="topless">
    <a href="../faq.html" title="next chapter">FAQ</a>
</p>


        {@ product_series @}
    </div>
</div>

            <div class="clearer"></div>
        </div>
    </div>
</body>